day1<-as.Date("03/10/2020",format = "%m/%d/%Y")
day2<-as.Date("03/24/2020",format = "%m/%d/%Y")
google_ts<-google%>%
mutate(Day = as.Date(as.character(Day)))
a<-google_ts %>%
#filter(Day<=day2)%>%
#filter(Day>=day1)%>%
group_by(Region, Day) %>%
summarize(ChinaVirusSearch = median(ChinaVirusInterest)) %>%
ggplot(aes(x=Day, y=ChinaVirusSearch, color=Region))+
geom_point()+
geom_vline(xintercept = Trump)+
geom_text(aes(Trump , 30, label = "Trump Tweets China Virus", vjust = -1), size = 3, color = "black")
ggplotly(a)
Trump<- as.Date("03/16/2020", format = "%m/%d/%Y")
day1<-as.Date("03/10/2020",format = "%m/%d/%Y")
day2<-as.Date("03/24/2020",format = "%m/%d/%Y")
google_ts<-google%>%
mutate(Day = as.Date(as.character(Day)))
a<-google_ts %>%
#filter(Day<=day2)%>%
#filter(Day>=day1)%>%
group_by(Region, Day) %>%
summarize(ChinaVirusSearch = median(ChinaVirusInterest)) %>%
ggplot(aes(x=Day, y=ChinaVirusSearch, color=Region))+
geom_point()+
geom_vline(xintercept = Trump)+
geom_text(aes(Trump , 100, label = "Trump Tweets China Virus", vjust = -1), size = 3, color = "black")
ggplotly(a)
Trump<- as.Date("03/16/2020", format = "%m/%d/%Y")
a<-google_ts %>%
#filter(Day<=day2)%>%
#filter(Day>=day1)%>%
group_by(Region, Day) %>%
summarize(ChinaVirusSearch = median(ChinaVirusInterest)) %>%
ggplot(aes(x=Day, y=ChinaVirusSearch, color=Region))+
geom_point()+
geom_vline(xintercept = Trump)+
geom_text(aes(Trump , 100, label = "Trump Tweets China Virus", vjust = -1), size = 3, color = "black")
ggplotly(a)
a<-google_ts %>%
#filter(Day<=day2)%>%
#filter(Day>=day1)%>%
group_by(Region, Day) %>%
summarize(ChinaVirusSearch = median(ChinaVirusInterest)) %>%
ggplot(aes(x=Day, y=ChinaVirusSearch, color=Region))+
geom_point()
ggplotly(a)
library(dplyr)
library(usmap)
library(maps)
library(ggplot2)
library(tidyverse)
library(ggmap)
library(viridis)
library(rgdal)
library(gridExtra)
library(plotly)
require(janitor)
require(reshape2)
require(tidyr)
require(rstan)
require(rstanarm)
require(bayesplot)
Finaldata<- read.csv("time_series_final_Data.csv")
google<-read.csv("Google/googlefinal.csv")
names(google)
google <- google %>%  select(-c(X.1))
Finaldata <- Finaldata %>% select(-c(X))
Finaldata <- Finaldata %>% mutate(Day= as.Date(Day))
dim(Finaldata)
names(Finaldata)
head(Finaldata)
summary(Finaldata)
Trump<- as.Date("03/16/2020", format = "%m/%d/%Y")
day1<-as.Date("03/10/2020",format = "%m/%d/%Y")
day2<-as.Date("03/24/2020",format = "%m/%d/%Y")
google_ts<-google%>%
mutate(Day = as.Date(as.character(Day)))
a<-google_ts %>%
#filter(Day<=day2)%>%
#filter(Day>=day1)%>%
group_by(Region, Day) %>%
summarize(ChinaVirusSearch = median(ChinaVirusInterest)) %>%
ggplot(aes(x=Day, y=ChinaVirusSearch, color=Region))+
geom_point()
ggplotly(a)
#Demographic: Identification
## Might not use, how helpful is this? Possibly combine into a shiny app so people could adjust for which race to look at?
Finaldata <- data.frame(Finaldata) %>% mutate(state = State)
plot_usmap(data = Finaldata, values = "percent_white", color = "white") +
scale_fill_continuous(name = "Percent White", label = scales::comma) +
theme(legend.position = "right")+ ggtitle("Percent of Residents that Identify as White") +
theme(
plot.title = element_text(color="Black", size=14, face="bold")
)
plot_usmap(data = Finaldata, values = "percent_asian", color = "white") +
scale_fill_continuous(low = "sky blue", high = "black", name = "Percent Asian", label = scales::comma) +
theme(legend.position = "right") + ggtitle("Percent of Residents that Identify as Asian") +
theme(
plot.title = element_text(color="Black", size=14, face="bold")
)
#By income
plot_usmap(data = Finaldata, values = "per_capita_income", color = "white") +
scale_fill_continuous(low = "sky blue", high = "black", name = "$ Per Capita", label = scales::comma) +
theme(legend.position = "right") + ggtitle("Income per Capita")+
theme(
plot.title = element_text(color="Black", size=14, face="bold")
)
#Income by state affiliation
g <- ggplot(Finaldata, aes(x = per_capita_income, fill = StateColor)) + geom_density(alpha = .8)+ ggtitle("Income per Capita") + xlab("$") + ylab("Density")
g + scale_fill_manual(values=c("blue", "purple", "red"))
#Trump Support
ggplot(Finaldata, aes(x = percent_republican2016)) +
geom_density()+ ggtitle("Trump Support During the 2016 Elections") + xlab("Percent of Trump Support") + ylab("Density") + facet_wrap(~Region)
ggplot(Finaldata, aes(x = percent_asian, y = percent_republican2016, color = Winner)) +
scale_color_manual(values = c("blue","purple","red")) +
geom_point(alpha = 0.8) + geom_text(aes(label=ifelse(percent_asian>.2,as.character(state),"")),hjust=1.2,vjust=0)+ geom_text(aes(label=ifelse(percent_republican2016<.2,as.character(state),"")),hjust=-.1,vjust=0) + ggtitle("Percent of Asians and Trump Support by Election Outcome") + xlab("Percent Asian") + ylab("Trump Support")
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="red",
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_continuous2
?scale_fill_gradient2
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="red", mid = "blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="red", mid = "blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="darkblue", mid = "blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="darkblue", mid = "blue",
name = "Cases(#)") +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="darkblue", mid = "blue",midpoint = mean(weekafter$positive)
name = "Cases(#)",label = scales::comma,
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="darkblue", mid = "blue",midpoint = mean(weekafter$positive),
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="red", mid = "blue",midpoint = mean(weekafter$positive),
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_continuous(low = "sky blue", high ="blue",
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="red", mid = "blue",midpoint = 500,
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="blue", mid = "skyblue",midpoint = 50,
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="red", mid = "blue",midpoint = 500,
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="blue", mid = "skyblue",midpoint = 30,
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "sky blue", high ="red", mid = "blue",midpoint = 500,
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="blue", mid = "skyblue",midpoint = 30,
name = "Cases(#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="red", mid = "blue",midpoint = 500,
name = "Cases(#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
## I would like help fixing this scale
?scale_fill_gradient2
## Creating a df of just the cases the week before 3/17
weekbefore <- data.frame(Finaldata) %>% filter(Day <= as.Date("2020-03-17"))
plot1<- plot_usmap(data = weekbefore, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="blue", mid = "skyblue",midpoint = 30,
name = "Cases (#)",label = scales::comma,
limits = c(0,500)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases Before 3/17") +
theme(
plot.title = element_text(color="Black", size=8)
)
## Creating a df of just the cases the week after 3/17
weekafter <- data.frame(Finaldata) %>% filter(Day >= as.Date("2020-03-17"))
plot2<-plot_usmap(data = weekafter, values = "positive", color = "white") +
scale_fill_gradient2(low = "white", high ="red", mid = "blue",midpoint = 500,
name = "Cases (#)",label = scales::comma,
limits = c(0,10000)) +
theme(legend.position = "right")+ ggtitle("# of COVID Cases After 3/17") +
theme(
plot.title = element_text(color="Black", size=5)
)
# The number of Positive Covid Cases, comparison before and after the China Virus announcement
grid.arrange(plot1, plot2, ncol=2)
mcmc_trace(model_1)
model_1 <- stan_glmer(
ChinaVirusInterest ~ (1 | Region),
data = Finaldata, family = gaussian, chains = 4, iter = 5000*2
)
set.seed(454)
model_1 <- stan_glmer(
ChinaVirusInterest ~ (1 | Region),
data = Finaldata, family = gaussian, chains = 4, iter = 5000*2
)
Finaldata
Finaldata%>%
select(ChinaVirusInterest,Region,State)
model_dataFinaldata%>%
select(ChinaVirusInterest,Region,State)
model_data<-Finaldata%>%
select(ChinaVirusInterest,Region,State)
model_1 <- stan_glmer(
ChinaVirusInterest ~ (1 | Region),
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
library(dplyr)
library(usmap)
library(maps)
library(ggplot2)
library(tidyverse)
library(ggmap)
library(viridis)
library(rgdal)
library(gridExtra)
library(plotly)
require(janitor)
require(reshape2)
require(tidyr)
require(rstan)
require(rstanarm)
require(bayesplot)
#model_1 build
set.seed(454)
model_1 <- stan_glm(
Reaction ~ 1,
data = sleep, family = gaussian,
chains = 4, iter = 5000*2
)
sleep <- read.csv("https://www.macalester.edu/~ajohns24/Data/SleepStudy.csv")
model_1 <- stan_glm(
Reaction ~ 1,
data = sleep, family = gaussian,
chains = 4, iter = 5000*2
)
set.seed(454)
model_data<-Finaldata%>%
select(ChinaVirusInterest,Region,State)
model_1 <- stan_glmer(
ChinaVirusInterest ~ 1,
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
model_1 <- stan_glmer(
ChinaVirusInterest ~ 1|State,
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
set.seed(454)
model_data<-Finaldata%>%
select(ChinaVirusInterest,Region,State)
model_1 <- stan_glmer(
ChinaVirusInterest ~ (1|State),
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
model_data<-Finaldata%>%
select(ChinaVirusInterest,Region,State,Day)
model_1 <- stan_glmer(
ChinaVirusInterest ~ (1|State),
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
model_1 <- stan_glmer(
ChinaVirusInterest ~ Day+(1|State),
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
set.seed(454)
model_data<-Finaldata%>%
select(ChinaVirusInterest,Region,State,Day)
model_1 <- stan_glmer(
ChinaVirusInterest ~ Day+(1|State),
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
#model_1 build
set.seed(454)
model_1 <- stan_glm(
Reaction ~ 1,
data = sleep, family = gaussian,
chains = 4, iter = 5000*2
)
model_1 <- stan_glmer(
ChinaVirusInterest ~ 1+(1|State),
data = model_data, family = gaussian, chains = 4, iter = 5000*2
)
model_data<-Finaldata%>%
select(ChinaVirusInterest,Region,State,Day)
Finaldata<-
Finaldata%>%
mutate(Day=as.numeric(Day))
Finaldata
model_1 <- stan_glmer(
ChinaVirusInterest ~ (1 | Region),
data = Finaldata, family = gaussian, chains = 4, iter = 5000*2
)
is.na(Finaldata$Region)
count(is.na(Finaldata$Region))
sum(is.na(Finaldata$Region))
